
<!--이벤트 고급 활용, 효율적인 이벤트 관리

캡처링 단계: 최상위 요소에서 대상 요소로 내려가는 과정
타겟 단계: 실제 이벤트가 발생한 요소에서 처리
버블링 단계: 대상 요소에서 최상위 요소로 올라가는 과정
-->

<!DOCTYPE html>
<html>
<head>
   <meta charset="UTF-8">
 <style>
 .container { padding: 20px; background: lightblue; }
 .box { padding: 15px; background: lightgreen; margin: 10px; }
 .button { padding: 10px; background: lightcoral; }
 </style>
</head>
<body>
 <div class="container" id="container">
 컨테이너
 <div class="box" id="box">
 박스
 <button class="button" id="button">버튼</button>
 </div>
 </div>

 <div id="log"></div>

 <script>
 const container = document.getElementById('container');
 const box = document.getElementById('box');
 const button = document.getElementById('button');
 const log = document.getElementById('log');

 function addLog(message) {
 log.innerHTML += message + '<br>';
 }

 // 버블링 단계에서 이벤트 처리
 container.addEventListener('click', () => addLog('컨테이너 클릭됨'));
 box.addEventListener('click', () => addLog('박스 클릭됨'));
 button.addEventListener('click', () => addLog('버튼 클릭됨'));

 button.addEventListener('click', (event) => {
 addLog('버튼 클릭됨 (전파 중단)');
 event.stopPropagation(); // 이벤트 전파 중단
});

// 또는 즉시 전파 중단
button.addEventListener('click', (event) => {
 addLog('버튼 클릭됨 (즉시 중단)');
 event.stopImmediatePropagation(); // 같은 요소의 다른 리스너도 중단
});


 </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>이벤트 위임 - Todo 리스트</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        ul {
            padding-left: 20px;
        }
        li {
            margin-bottom: 8px;
        }
        button {
            margin-left: 10px;
        }
    </style>
</head>
<body>

<h2>할 일 목록 (이벤트 위임)</h2>

<ul id="todoList">
    <li data-id="1">할 일 1 <button class="delete">삭제</button></li>
    <li data-id="2">할 일 2 <button class="delete">삭제</button></li>
    <li data-id="3">할 일 3 <button class="delete">삭제</button></li>
</ul>

<button id="addTodo">할 일 추가</button>

<script>
    const todoList = document.getElementById('todoList');
    const addTodo = document.getElementById('addTodo');
    let todoCount = 3;

    // ✅ 이벤트 위임
    todoList.addEventListener('click', (event) => {
        if (event.target.classList.contains('delete')) {
            const li = event.target.parentElement;
            const todoId = li.dataset.id;

            if (confirm(`할 일 ${todoId}를 삭제하시겠습니까?`)) {
                li.remove();
            }
        }
    });

    // ✅ 새 할 일 추가 (이벤트 리스너 재등록 X)
    addTodo.addEventListener('click', () => {
        todoCount++;
        const newTodo = document.createElement('li');
        newTodo.dataset.id = todoCount;
        newTodo.innerHTML = `할 일 ${todoCount} <button class="delete">삭제</button>`;
        todoList.appendChild(newTodo);
    });
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>고급 이벤트 처리</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        button {
            margin: 5px;
        }
        .clickable {
            padding: 10px;
            background: #e5e7eb;
            display: inline-block;
            cursor: pointer;
        }
    </style>
</head>
<body>

<h2>조건부 이벤트 & 쓰로틀링</h2>

<div class="clickable">클릭 가능한 요소</div>
<br><br>

<button data-action="delete">삭제</button>
<button data-action="edit">수정</button>
<button data-action="save">저장</button>

<p style="margin-top: 1000px;">
    아래로 스크롤 해보세요 (콘솔 확인)
</p>

<script>
    // 1️⃣ 조건부 이벤트 처리 (이벤트 위임 + 필터링)
    document.addEventListener('click', (event) => {

        // 특정 클래스만 처리
        if (event.target.matches('.clickable')) {
            console.log('클릭 가능한 요소가 클릭됨');
        }

        // data-action 기반 분기
        if (event.target.matches('[data-action]')) {
            const action = event.target.dataset.action;
            handleAction(action, event.target);
        }
    });

    function handleAction(action, element) {
        switch (action) {
            case 'delete':
                deleteItem(element);
                break;
            case 'edit':
                editItem(element);
                break;
            case 'save':
                saveItem(element);
                break;
        }
    }

    function deleteItem(el) {
        console.log('삭제 처리');
    }

    function editItem(el) {
        console.log('수정 처리');
    }

    function saveItem(el) {
        console.log('저장 처리');
    }

    // 2️⃣ 이벤트 쓰로틀링 (성능 최적화)
    function throttle(func, delay) {
        let lastExecTime = 0;

        return function (...args) {
            const currentTime = Date.now();

            if (currentTime - lastExecTime > delay) {
                func.apply(this, args);
                lastExecTime = currentTime;
            }
        };
    }

    // 스크롤 이벤트 최적화
    window.addEventListener('scroll', throttle(() => {
        console.log('스크롤 이벤트 처리');
    }, 100));
</script>

</body>
</html>

